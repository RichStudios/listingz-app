{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import axios from'axios';// Create context\nimport{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('token'));const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Set auth token\nconst setAuthToken=token=>{if(token){axios.defaults.headers.common['Authorization']=`Bearer ${token}`;localStorage.setItem('token',token);}else{delete axios.defaults.headers.common['Authorization'];localStorage.removeItem('token');}};// Load user\nconst loadUser=async()=>{if(token){setAuthToken(token);try{const res=await axios.get('/api/users/me');setUser(res.data.data);setIsAuthenticated(true);}catch(err){var _err$response,_err$response$data;localStorage.removeItem('token');setToken(null);setUser(null);setIsAuthenticated(false);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Authentication error');}}setLoading(false);};// Register user\nconst register=async formData=>{try{const res=await axios.post('/api/users/register',formData);setToken(res.data.token);setAuthToken(res.data.token);await loadUser();return{success:true};}catch(err){var _err$response2,_err$response2$data,_err$response3,_err$response3$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Registration failed');return{success:false,error:((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'Registration failed'};}};// Login user\nconst login=async formData=>{try{const res=await axios.post('/api/users/login',formData);setToken(res.data.token);setAuthToken(res.data.token);await loadUser();return{success:true};}catch(err){var _err$response4,_err$response4$data,_err$response5,_err$response5$data;setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||'Login failed');return{success:false,error:((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||'Login failed'};}};// Logout user\nconst logout=()=>{localStorage.removeItem('token');setToken(null);setUser(null);setIsAuthenticated(false);setError(null);};// Clear errors\nconst clearErrors=()=>setError(null);// Effect to load user on initial load\nuseEffect(()=>{loadUser();},[loadUser]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{token,isAuthenticated,loading,user,error,register,login,logout,clearErrors,loadUser},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","isAuthenticated","setIsAuthenticated","loading","setLoading","error","setError","setAuthToken","defaults","headers","common","setItem","removeItem","loadUser","res","get","data","err","_err$response","_err$response$data","response","message","register","formData","post","success","_err$response2","_err$response2$data","_err$response3","_err$response3$data","login","_err$response4","_err$response4$data","_err$response5","_err$response5$data","logout","clearErrors","Provider","value"],"sources":["C:/Users/Dr. Simon/Documents/Listingz/listingz-app/client/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\n// Create context\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(localStorage.getItem('token'));\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Set auth token\r\n  const setAuthToken = (token) => {\r\n    if (token) {\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      localStorage.setItem('token', token);\r\n    } else {\r\n      delete axios.defaults.headers.common['Authorization'];\r\n      localStorage.removeItem('token');\r\n    }\r\n  };\r\n\r\n  // Load user\r\n  const loadUser = async () => {\r\n    if (token) {\r\n      setAuthToken(token);\r\n      \r\n      try {\r\n        const res = await axios.get('/api/users/me');\r\n        \r\n        setUser(res.data.data);\r\n        setIsAuthenticated(true);\r\n      } catch (err) {\r\n        localStorage.removeItem('token');\r\n        setToken(null);\r\n        setUser(null);\r\n        setIsAuthenticated(false);\r\n        setError(err.response?.data?.message || 'Authentication error');\r\n      }\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  // Register user\r\n  const register = async (formData) => {\r\n    try {\r\n      const res = await axios.post('/api/users/register', formData);\r\n      \r\n      setToken(res.data.token);\r\n      setAuthToken(res.data.token);\r\n      await loadUser();\r\n      return { success: true };\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Registration failed');\r\n      return { success: false, error: err.response?.data?.message || 'Registration failed' };\r\n    }\r\n  };\r\n\r\n  // Login user\r\n  const login = async (formData) => {\r\n    try {\r\n      const res = await axios.post('/api/users/login', formData);\r\n      \r\n      setToken(res.data.token);\r\n      setAuthToken(res.data.token);\r\n      await loadUser();\r\n      return { success: true };\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Login failed');\r\n      return { success: false, error: err.response?.data?.message || 'Login failed' };\r\n    }\r\n  };\r\n\r\n  // Logout user\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    setToken(null);\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n    setError(null);\r\n  };\r\n\r\n  // Clear errors\r\n  const clearErrors = () => setError(null);\r\n\r\n  // Effect to load user on initial load\r\n  useEffect(() => {\r\n    loadUser();\r\n  }, [loadUser]);\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        token,\r\n        isAuthenticated,\r\n        loading,\r\n        user,\r\n        error,\r\n        register,\r\n        login,\r\n        logout,\r\n        clearErrors,\r\n        loadUser\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}